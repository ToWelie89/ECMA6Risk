<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="shortcut icon" href="icon.ico">
    <title>TotalRisk</title>

    <!-- Fix for electron -->
    <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>

    <!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js'></script> -->
    <!-- <script src="/socket.io/socket.io.js"></script> -->
    <script src="js/libs/socket.io.js"></script>
    <script>
        let electron;
        let ipcRenderer;
        let io;
        if (!!(window && window.process && window.process.type)) { // If running Electron
            electron = require('electron');
            ipcRenderer = require('electron').ipcRenderer;
            //io = require('socket.io-client');
        }
    </script>
    <script src='js/libs/responsivevoice.js'></script>
    <script src='js/libs/three.min.js'></script>
    <script src='js/libs/cannon.min.js'></script>
    <script src='js/libs/dice.js'></script>
    <script src="node_modules/angular/angular.min.js"></script>
    <script src="node_modules/angular-sanitize/angular-sanitize.min.js"></script>
    <script src="node_modules/angular-ui-bootstrap/dist/ui-bootstrap.js"></script>
    <script src="node_modules/angular-ui-bootstrap/dist/ui-bootstrap-tpls.js"></script>
    <script src="node_modules/angularjs-slider/dist/rzslider.min.js"></script>
    <script src="node_modules\izitoast\dist\js\iziToast.min.js"></script>
    <script src="assetsDist/app.bundle.js"></script>

    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.2/velocity.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.2/velocity.ui.min.js'></script> -->
    <!-- <script src='js/libs/zoom.js'></script>
    <script src='js/libs/zoomooz.js'></script> -->

    <!-- Fix for electron -->
    <script>if (window.module) module = window.module;</script>

    <link href="node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="node_modules/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
    <link href="node_modules\izitoast\dist\css\iziToast.min.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" type="text/css" href="node_modules/angularjs-slider/dist/rzslider.css">

    <link href="cssLibs/animate.css" rel="stylesheet" type="text/css">
    <link href="cssLibs/csshake.css" rel="stylesheet" type="text/css">
    <link href="assetsDist/default.css" rel="stylesheet" type="text/css">

    <!-- <link href='https://fonts.googleapis.com/css?family=Finger+Paint' rel='stylesheet' type='text/css'>-->
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
</head>

<body ng-app="risk" data-ng-controller="mainController as main" data-ng-class="{'endScreen': main.currentGamePhase === main.gamePhases.END_SCREEN}">
    <div id="authenticationBox" data-ng-show="main.currentGamePhase == main.gamePhases.MAIN_MENU || main.currentGamePhase == main.gamePhases.SETTINGS || main.currentGamePhase == main.gamePhases.PLAYER_SETUP || main.currentGamePhase == main.gamePhases.CHARACTER_CREATOR || main.currentGamePhase == main.gamePhases.PLAYER_SETUP_MULTIPLAYER || main.currentGamePhase === main.gamePhases.MULTIPLAYER_LOBBIES" data-ng-controller="authenticationController as auth" ng-cloak>
        <div data-ng-show="auth.currentState === auth.states.LOGGED_IN || auth.currentState === auth.states.EDIT_PROFILE">
            <p>
                Logged in as {{ auth.user.displayName ? auth.user.displayName : auth.user.email }}
            </p>
            <button type="button" class="button button-red marginLeft" data-ng-click="auth.logout()">
                Logout
            </button>
        </div>
        <div data-ng-show="auth.currentState === auth.states.LOGGED_IN || auth.currentState === auth.states.EDIT_PROFILE" id="editProfile">
            <p class="fakeLink" data-ng-click="auth.goToState(auth.states.EDIT_PROFILE)" data-ng-show="auth.currentState === auth.states.LOGGED_IN">
                Edit profile
            </p>
            <div data-ng-show="auth.currentState === auth.states.EDIT_PROFILE">
                <p class="paddingBottom paddingTop--double">Display name</p>
                <input type="text" data-ng-model="auth.newDisplayNameData" class="marginRight" placeholder="Display name" maxlength="20" />
                <button type="button" class="button button-red marginTop" data-ng-click="auth.cancelUpdate()">
                    Cancel
                </button>
                <button type="button" class="button button-green marginTop" data-ng-click="auth.updateProfile()">
                    Update profile
                </button>
            </div>
        </div>
        <div data-ng-show="auth.currentState === auth.states.NOT_LOGGED_IN">
            <p>
                You are not logged in
            </p>
            <button type="button" class="button button-green marginLeft" data-ng-click="auth.goToState(auth.states.LOGIN)">
                Login
            </button>
            <button type="button" class="button button-green marginLeft" data-ng-click="auth.goToState(auth.states.SIGNUP)">
                Signup
            </button>
        </div>
        <div data-ng-show="auth.currentState === auth.states.LOGIN">
            <button type="button" class="button button-green marginRight" data-ng-click="auth.goToState(auth.states.NOT_LOGGED_IN)">
                <span class="glyphicon glyphicon-arrow-left"></span>
            </button>
            <input type="text" data-ng-model="auth.loginData.email" class="marginRight" placeholder="Email" />
            <input type="password" data-ng-model="auth.loginData.password" class="marginRight" placeholder="Password" />
            <button type="button" class="button button-green" data-ng-click="auth.login()">
                Login
            </button>
        </div>
        <div data-ng-show="auth.currentState === auth.states.SIGNUP">
            <button type="button" class="button button-green marginRight" data-ng-click="auth.goToState(auth.states.NOT_LOGGED_IN)">
                <span class="glyphicon glyphicon-arrow-left"></span>
            </button>
            <input type="text" data-ng-model="auth.signupData.email" class="marginRight" placeholder="Email" />
            <input type="password" data-ng-model="auth.signupData.password" class="marginRight" placeholder="Password" />
            <button type="button" class="button button-green" data-ng-click="auth.signup()">
                Signup
            </button>
        </div>
    </div>

    <!-- <button data-ng-click="main.startHosting()" data-ng-disabled="main.connected">Start hosting</button>
    <button data-ng-click="main.connectToHost()" data-ng-disabled="main.connected">Connect to host</button>
    <button data-ng-click="main.sendMessage('Hello')">Hello!</button>
    <p>my ip is: {{main.myIp}}</p> -->

    <div class="wrapper mainWrapper">
        <div class="textCenter mainMenuBox" data-ng-hide="main.currentGamePhase === main.gamePhases.GAME || main.currentGamePhase === main.gamePhases.AI_TESTING || main.currentGamePhase === main.gamePhases.TUTORIAL || main.currentGamePhase === main.gamePhases.END_SCREEN">
            <div>
                <div class="logoContainer">
                    @@logo
                </div>
                <div class="createdBy">
                    <span>{{ main.appVersion }}
                    | Created by</span> <a href="http://www.martinsonesson.se" target="_blank">Martin Sonesson</a> | <a href="https://github.com/ToWelie89/TotalRisk" target="_blank">Source code</a>
                </div>
            </div>
        </div>
        <div class="container mainContent">
            <div data-ng-show="main.currentGamePhase == main.gamePhases.MAIN_MENU" class="textCenter mainMenuBox">
                <div style="margin-top: 70px;
                            width: 600px;
                            margin: 0 auto;
                            padding-top: 30px;
                            padding-bottom: 40px;
                            background: rgba(59, 59, 59, 0.788235294117647);
                            border-radius: 30px;">
                    <button type="button" class="button button-green main-menu-button" data-ng-click="main.setGamePhase(main.gamePhases.PLAYER_SETUP)">
                        <div class="main-menu-button-icon" id="newGameIcon">
                            @@newGameIcon
                        </div>
                        <strong>Local Game</strong>
                    </button>
                    <button type="button" class="button button-green main-menu-button" data-ng-click="main.setGamePhase(main.gamePhases.MULTIPLAYER_LOBBIES)">
                        <div class="main-menu-button-icon" id="newGameIcon">
                            @@newGameIcon
                        </div>
                        <strong>Online Game</strong>
                    </button>
                    <button type="button" class="button button-green main-menu-button" data-ng-disabled="true">
                        <strong>Load Game</strong>
                    </button>
                    <button type="button" class="button button-green main-menu-button" data-ng-click="main.startTutorial()">
                        <div class="main-menu-button-icon" id="tutorialIcon">
                            @@tutorialIcon
                        </div>
                        <strong>Tutorial</strong>
                    </button>
                    <button type="button" class="button button-green main-menu-button" data-ng-click="main.setGamePhase(main.gamePhases.CHARACTER_CREATOR)">
                        <div class="main-menu-button-icon" id="characterEditorIcon">
                            @@characterEditorIcon
                        </div>
                        <strong>Character Editor</strong>
                    </button>
                    <button type="button" class="button button-green main-menu-button" data-ng-click="main.setGamePhase(main.gamePhases.SETTINGS)">
                        <div class="main-menu-button-icon" id="settingsIcon">
                            @@settingsIcon
                        </div>
                        <strong>Settings</strong>
                    </button>
                </div>
            </div>
            <div data-ng-show="main.currentGamePhase == main.gamePhases.SETTINGS" class="textCenter mainMenuBox" data-ng-controller="settingsController as settings" ng-cloak>
                <div class="backButtonContainer">
                    <button type="button" class="button button-green" data-ng-click="main.setGamePhase(main.gamePhases.MAIN_MENU)">
                        <span class="glyphicon glyphicon-arrow-left"></span>
                    </button>
                </div>
                <div id="settingsBox" style="margin-top: 70px;
                                             width: 100%;
                                             margin: 0 auto;
                                             padding-top: 30px;
                                             padding-bottom: 40px;
                                             background: rgba(59, 59, 59, 0.788235294117647);
                                             border-radius: 30px;">
                    <div class="row paddingLeft--double paddingRight--double">
                        <strong style="color: white;" data-ng-show="!settings.runningElectron">
                            The settings that you configure here will be automatically saved to your browsers local storage so that you don't have to reset them everytime.
                        </strong>
                    </div>

                    <div class="row" style="width: 600px; margin: 0 auto;">
                        <div class="col-xs-4">
                            <div>
                                AI Speed
                            </div>
                        </div>
                        <div class="col-xs-8">
                            <rzslider rz-slider-model="settings.aiSpeed" rz-slider-options="settings.movementSliderOptions"></rzslider>
                        </div>
                    </div>
                    <div class="row" style="width: 600px; margin: 0 auto;">
                        <div class="col-xs-4">
                            <div>
                                Play sound
                            </div>
                        </div>
                        <div class="col-xs-8 settingContainer" data-toggle="buttons">
                            <div>
                                <label class="switch" data-ng-click="settings.toggleSound()">
                                    <input type="checkbox" class="switch-input" data-ng-checked="settings.settings.playSound">
                                    <span class="switch-label" data-on="On" data-off="Off"></span>
                                    <span class="switch-handle"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="row" style="width: 600px; margin: 0 auto;">
                        <div class="col-xs-4">
                            <div>
                                Show announcer <span class="glyphicon glyphicon-info-sign" data-toggle="tooltip"
                                 data-placement="bottom" title="If turned on each turn will be presented by a announcer." style="color: #f0f048;"></span>
                            </div>
                        </div>
                        <div class="col-xs-8 settingContainer" data-toggle="buttons">
                            <div>
                                <label class="switch" data-ng-click="settings.toggleAnnouncer()">
                                    <input type="checkbox" class="switch-input" data-ng-checked="settings.settings.showAnnouncer">
                                    <span class="switch-label" data-on="On" data-off="Off"></span>
                                    <span class="switch-handle"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="row" data-ng-show="settings.runningElectron" style="width: 600px; margin: 0 auto;">
                        <div class="col-xs-4">
                            <div>
                                Full Screen
                            </div>
                        </div>
                        <div class="col-xs-8 settingContainer" data-toggle="buttons">
                            <div>
                                <label class="switch" data-ng-click="settings.toggleFullScreen()">
                                    <input type="checkbox" class="switch-input" data-ng-checked="settings.settings.fullScreen">
                                    <span class="switch-label" data-on="On" data-off="Off"></span>
                                    <span class="switch-handle"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div data-ng-show="main.currentGamePhase == main.gamePhases.CHARACTER_CREATOR" class="textCenter mainMenuBox" data-ng-controller="characterCreatorController as characterCreator" id="characterEditor" ng-cloak>
                <div id="mainDiv">
                    <div class="backButtonContainer">
                        <button type="button" class="button button-green" data-ng-click="main.setGamePhase(main.gamePhases.MAIN_MENU)">
                            <span class="glyphicon glyphicon-arrow-left"></span>
                        </button>
                    </div>
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="existingCharactersContainer" data-ng-show="characterCreator.characters.length > 0">
                                <div class="existingCharactersContainer__item" data-ng-class="{'existingCharactersContainer__item-selected': characterCreator.selectedCharacterId === character.id}" data-ng-repeat="character in characterCreator.characters track by $index" data-ng-click="characterCreator.selectCharacter(character)">
                                    <div class="existingCharactersContainer__item__inner" character="{{ character.id }}">
                                        @@customCharacterSvg
                                    </div>
                                </div>
                                <div class="existingCharactersContainer__item" data-ng-click="characterCreator.createNewCharacter()">
                                    <div class="existingCharactersContainer__item__inner">
                                        <span class="glyphicon glyphicon-plus">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" data-ng-show="characterCreator.showEditor">
                        <div class="col-xs-8" id="editorSvgContainer">
                            @@customCharacterSvg
                        </div>
                        <div class="col-xs-4" id="editorControls">
                            <div class="row">
                                <div class="col-xs-12" style="display: table-cell; width: 100%;">
                                    <input type="text" placeholder="Name" data-ng-model="characterCreator.name" maxlength="20" />
                                </div>
                            </div>
                            <div data-ng-repeat="bodypart in characterCreator.currentSelection" style="display: table-row;">
                                <div style="display: table-cell; padding-top: 3px;">
                                    <button type="button" class="button button-blue arrowButton" data-ng-click="characterCreator.previousPart(bodypart.type)">
                                        <p>
                                            <span class="glyphicon glyphicon-arrow-left"></span>
                                        </p>
                                    </button>
                                </div>
                                <div style="display: table-cell; color: white; width: 100%;">
                                    {{ bodypart.displayName }} ({{ bodypart.selection }} / {{ bodypart.maxChoices }})
                                </div>
                                <div style="display: table-cell;">
                                    <button type="button" class="button button-blue arrowButton" data-ng-click="characterCreator.nextPart(bodypart.type)">
                                        <span class="glyphicon glyphicon-arrow-right"></span>
                                    </button>
                                </div>
                            </div>
                            <div class="row marginTop">
                                <button type="button" class="button button-blue" data-ng-click="characterCreator.randomize()">
                                    Randomize
                                </button>
                                <button type="button" class="button button-red" data-ng-click="characterCreator.deleteCharacter()" data-ng-show="characterCreator.selectedCharacterId">
                                    Delete
                                </button>
                                <button type="button" class="button button-green" data-ng-click="characterCreator.saveCharacter()" data-ng-disabled="characterCreator.name.length === 0">
                                    <span data-ng-show="!characterCreator.selectedCharacterId">Save</span>
                                    <span data-ng-show="characterCreator.selectedCharacterId">Update</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="row" data-ng-show="!characterCreator.showEditor">
                        <div class="col-xs-12">
                            <div data-ng-show="characterCreator.characters.length === 0">
                                <div class="paddingTop--double paddingBottom--double">
                                    <strong style="color: white;">
                                        You have not created any characters yet
                                    </strong>
                                </div>
                                <button type="button" class="button button-purple large" data-ng-click="characterCreator.createNewCharacter()">
                                    Create new character
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div data-ng-show="main.currentGamePhase == main.gamePhases.PLAYER_SETUP_MULTIPLAYER" data-ng-controller="lobbyController as lobby" ng-cloak>
                <div class="backButtonContainer">
                    <button type="button" class="button button-green" data-ng-click="lobby.leaveLobby()">
                        <span class="glyphicon glyphicon-arrow-left"></span>
                    </button>
                </div>
                <div class="row mainMenuBox textCenter">
                    <div id="lobbiesContainer">
                        <h3>{{ lobby.room.currentNumberOfPlayers }}</h3>
                        <h3>{{ lobby.room.roomName }}</h3>
                        <h3>{{ lobby.userIsHost }}</h3>
                        <div>
                            <input type="text" data-ng-model="lobby.message" />
                            <button type="button" class="button button-green" data-ng-click="lobby.sendMessage()">
                                Send
                            </button>
                        </div>
                        <div>
                            <div data-ng-repeat="message in lobby.messages" style="color: white;">
                                <strong>{{message.sender}}</strong> ({{message.timestamp}}): {{message.message}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div data-ng-show="main.currentGamePhase == main.gamePhases.MULTIPLAYER_LOBBIES" data-ng-controller="lobbiesController as lobbies" ng-cloak>
                <div class="backButtonContainer">
                    <button type="button" class="button button-green" data-ng-click="main.setGamePhase(main.gamePhases.MAIN_MENU)">
                        <span class="glyphicon glyphicon-arrow-left"></span>
                    </button>
                </div>
                <div class="row mainMenuBox textCenter">
                    <div id="lobbiesContainer">
                        <div data-ng-show="!lobbies.isAuthenticated" class="warning">
                            <div class="alert alert-warning" role="alert">
                                You must be logged in to host or join an online game.
                            </div>
                        </div>
                        <div id="lobbiesButtons">
                            <button type="button" class="button button-blue large" data-ng-click="lobbies.hostNewGame()" data-ng-disabled="!lobbies.isAuthenticated">
                                Host new game
                            </button>
                            <input id="searchBar" type="text" placeholder="Search rooms" data-ng-show="lobbies.lobbies.length !== 0" />
                        </div>
                        <div class="warning paddingTop--double" data-ng-show="lobbies.lobbies.length === 0">
                            <div class="alert alert-info" role="alert">
                                There are no active lobbies.
                            </div>
                        </div>
                        <div id="lobbyList">
                            <div id="theadContainer" data-ng-show="lobbies.lobbies.length > 0">
                                <div class="lobbyRow thead">
                                    <div class="lobbyCell"></div>
                                    <div class="lobbyCell">Name</div>
                                    <div class="lobbyCell">Version</div>
                                    <div class="lobbyCell">Creator</div>
                                    <div class="lobbyCell">Players</div>
                                    <div class="lobbyCell">Created</div>
                                    <div class="lobbyCell"></div>
                                </div>
                            </div>
                            <div id="tbodyContainer" data-ng-show="lobbies.lobbies.length > 0">
                                <div id="tbody">
                                    <div data-ng-repeat="lobby in lobbies.lobbies" class="lobbyRow">
                                        <div class="lobbyCell">
                                            <span class="glyphicon glyphicon-lock" data-ng-show="lobby.private"></span>
                                        </div>
                                        <div class="lobbyCell" data-ng-bind="lobby.roomName"></div>
                                        <div class="lobbyCell" data-ng-bind="lobby.version"></div>
                                        <div class="lobbyCell" data-ng-bind="lobby.creator"></div>
                                        <div class="lobbyCell">
                                            {{lobby.currentNumberOfPlayers}} / {{lobby.maxNumberOfPlayer}}
                                        </div>
                                        <div class="lobbyCell" data-ng-bind="lobby.normalizedTime"></div>
                                        <div class="lobbyCell">
                                            <button type="button" class="button button-green joinButton" data-ng-click="lobbies.joinLobby(lobby)" data-ng-disabled="!lobbies.isAuthenticated || lobby.currentNumberOfPlayers === lobby.maxNumberOfPlayer">
                                                <strong>Join</strong>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div data-ng-show="main.currentGamePhase == main.gamePhases.PLAYER_SETUP" data-ng-controller="gameSetupController as setup" data-ng-init="setup.init()" ng-cloak>
                <div class="backButtonContainer">
                    <button type="button" class="button button-green" data-ng-click="main.setGamePhase(main.gamePhases.MAIN_MENU)">
                        <span class="glyphicon glyphicon-arrow-left"></span>
                    </button>
                </div>
                <div class="row mainMenuBox textCenter">
                <div id="gameSetupBox">
                    <div class="row">
                        <div class="col-xs-12 textCenter marginTop--double">
                            <div class="buttonGroup" style="height: 40px;">
                                <button type="button" class="button button-green button-unclickable">
                                    <strong>Map control percentage for victory</strong>
                                </button>
                                <button type="button" class="button button-green" data-ng-repeat="goal in setup.victoryGoals"
                                data-ng-class="{'button--selected': goal === setup.chosenGoal}" data-ng-click="setup.setGoal(goal)" data-ng-show="setup.players.length >= goal.requiredAmountOfPlayers">
                                    <strong data-ng-if="goal.type === 'mapControl'">{{goal.percentage}}%</strong>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="row textCenter">
                        <div class="setupBoxAvatarsContainer">
                            <div data-ng-repeat="i in [0,1,2,3,4,5] track by $index" class="setupBoxAvatarsContainer__item">
                                <div
                                    data-ng-if="setup.players[i] && setup.players[i].avatar"
                                    class="box-shadow setupBoxAvatarsContainer__item__portrait"
                                    style="background-image: url({{setup.players[i].avatar.picture}});
                                           border-color: {{setup.players[i].color.mainColor}};">
                                    <div class="setupBoxAvatarsContainer__item__portrait__inner"
                                         data-ng-click="setup.openSelectionScreen(setup.players[i])"
                                         style="border-color: {{setup.players[i].color.mainColor}};">
                                        <h2>CHANGE</h2>
                                    </div>
                                </div>
                                <div data-ng-if="setup.players[i]" class="box-shadow setupBoxAvatarsContainer__item__name">
                                    <div style="background: {{setup.players[i].color.mainColor}};" class="box-shadow" data-color="{{setup.players[i].color.mainColor}}">
                                        <span style="border-color: {{setup.lightenDarkenColor(setup.players[i].color.mainColor, -30)}}; border-left-color: transparent;"></span>
                                        <span>{{ setup.players[i].name }}{{ (setup.players[i].type !== 0) ? " (AI)" : "" }}</span>
                                        <span style="border-color: {{setup.lightenDarkenColor(setup.players[i].color.mainColor, -30)}}; border-right-color: transparent;"></span>
                                    </div>
                                </div>
                                <div
                                    data-ng-if="setup.players[i]"
                                    class="setupBoxAvatarsContainer__item__color box-shadow"
                                    style="background-color: {{setup.players[i].color.mainColor}}; border-color: {{setup.lightenDarkenColor(setup.players[i].color.mainColor, -50)}}"
                                    role="button"
                                    tabIndex="0"
                                    popover-placement="left"
                                    popover-title="Select a color"
                                    popover-trigger="'focus'"
                                    uib-popover-template="'src/popoverColorTemplate.html'"
                                    data-ng-controller="colorPopoverController as colorPopover"
                                    data-ng-init="colorPopover.init(setup.players[i])"
                                >
                                    <i class="fas fa-paint-brush"></i>
                                </div>
                                <div
                                    data-ng-if="setup.players[i]"
                                    class="setupBoxAvatarsContainer__item__type box-shadow"
                                    style="background-color: {{setup.players[i].color.mainColor}}; border-color: {{setup.lightenDarkenColor(setup.players[i].color.mainColor, -50)}}"
                                    role="button"
                                    tabIndex="0"
                                    popover-placement="left"
                                    popover-title="Select a type (human or AI)"
                                    popover-trigger="'focus'"
                                    uib-popover-template="'src/popoverPlayerTypeTemplate.html'"
                                    data-ng-controller="playerTypePopoverController as playerTypePopover"
                                    data-ng-init="playerTypePopover.init(setup.players[i])"
                                >
                                    <i class="fas fa-user" data-ng-show="setup.players[i].type === 0"></i>
                                    <i class="fas fa-desktop" data-ng-show="setup.players[i].type !== 0"></i>
                                </div>
                                <div
                                    data-ng-if="setup.players[i]"
                                    data-ng-class="{'setupBoxAvatarsContainer__item__delete--disabled': setup.players.length == setup.minPlayers}"
                                    class="setupBoxAvatarsContainer__item__delete box-shadow"
                                    style="background-color: {{setup.players[i].color.mainColor}}; border-color: {{setup.lightenDarkenColor(setup.players[i].color.mainColor, -50)}}"
                                    data-ng-click="setup.removePlayer(setup.players[i])"
                                >
                                    <i class="fas fa-trash-alt"></i>
                                </div>
                                <div class="setupBoxAvatarsContainer__item__flag" data-ng-if="setup.players[i]">
                                    <waving-flag flag-width="90" flag-height="50" flag-url="setup.players[i].avatar.flag"></waving-flag>
                                </div>

                                <div
                                    class="box-shadow setupBoxAvatarsContainer__item__portrait empty"
                                    data-ng-click="setup.openSelectionScreen(null)"
                                    data-ng-if="!setup.players[i]"
                                >
                                    <div>
                                        <span class="glyphicon glyphicon-plus">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row marginTop--double">
                        <div class="col-xs-12 textCenter gameSetupError" data-ng-show="setup.hasDuplicates()">
                            You are not allowed to have duplicate names.
                        </div>
                    </div>
                    <div class="row marginTop">
                        <div class="col-xs-12 textCenter gameSetupError" data-ng-show="setup.emptyNamesExists()">
                            Empty player names are not allowed.
                        </div>
                    </div>
                    <div class="row marginTop">
                        <div class="col-xs-12 textCenter gameSetupWarning" data-ng-show="setup.onlyAIsExists()">
                            Only AI players exists. Are you sure no human player wants to play?
                        </div>
                    </div>
                    <div class="row marginTop">
                        <div class="col-xs-12 textCenter">
                            <div class="buttonGroup">
                                <!-- <button type="button" class="button button-blue" data-ng-click="setup.addPlayer()" data-ng-disabled="setup.players.length == setup.maxPlayers" data-toggle="tooltip"
                                     data-placement="bottom" title="Add player">
                                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span><span class="glyphicon glyphicon-user" aria-hidden="true"></span>
                                </button> -->
                                <button type="button" class="button button-green large" data-ng-disabled="setup.startGameIsDisabled()" data-ng-click="main.startGame(setup.players, setup.chosenGoal)">
                                    <strong>Start</strong>
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- TESTING STUFF -->
                    <div class="row marginTop--double" data-ng-hide="true">
                        <div class="col-xs-12 textCenter">
                            <button type="button" class="button button-blue" data-ng-click="game.testAttackPhase(setup.players)">
                                <strong>Test battle modal</strong>
                            </button>
                            <button type="button" class="button button-blue" data-ng-click="game.testPresentationModal()">
                                <strong>Test presentation modal</strong>
                            </button>
                            <button type="button" class="button button-blue" data-ng-click="main.aiTester()">
                                <strong>AI tester</strong>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container mainContent" data-ng-controller="gameController as game"">
            <div data-ng-show="main.currentGamePhase == main.gamePhases.GAME || main.currentGamePhase == main.gamePhases.AI_TESTING || main.currentGamePhase == main.gamePhases.TUTORIAL || main.currentGamePhase == main.gamePhases.END_SCREEN" data-ng-class="{'gameScreenDuringVictory': main.currentGamePhase == main.gamePhases.END_SCREEN}" ng-cloak>
                <div class="row" style="background: rgba(67, 64, 64, 0.6901960784313725);
                                        border-radius: 30px;
                                        border-bottom-left-radius: 60px; border-top-left-radius: 60px;">
                    <div class="col-xs-4 textCenter paddingTop--double " style="padding-left:0px;">
                        <div class="col-xs-3" id="mainTurnAvatar" style="background-image: url({{ game.turn.player.avatar.picture }});"></div>
                        <div class="col-xs-9">
                            <div class="col-xs-12" style="padding: 0px;">
                                <strong id="playerName" class="floatLeft text-shadow" style="letter-spacing: -2px; line-height: 30px; color: {{ game.getCurrentPlayerColor() }}"><span data-ng-bind="game.turn.player.name"></span></strong>
                            </div>
                            <div class="col-xs-12" style="padding: 0px;">
                                <img src="assets/img/cards.png"
                                     id="cardButton"
                                     class="floatLeft"
                                     style="width: 30px;"
                                     data-ng-disabled="game.turn.turnPhase !== 0"
                                     data-ng-click="game.turnInCards()"
                                     data-ng-class="{'cardButton--disabled': game.aiTurn}"
                                     data-toggle="tooltip"
                                     data-placement="bottom"
                                     value="Open cards view" />
                                <h4 class="floatLeft marginLeft" id="cardCounter">({{game.turn.player.cards.length}})</h4>
                            </div>
                        </div>
                    </div>
                    <div id="filters" class="paddingTop--double paddingBottom--double col-xs-5 textCenter" style="padding-right:0px;">
                        <div class="buttonGroup">
                            <button type="button" class="button button-blue" data-ng-class="{'filter-selected': game.filter === 'byOwner'}" id="showByOwner" data-ng-click="game.filterByOwner()">
                                <strong>Color by owner</strong>
                            </button>
                            <button type="button" class="button button-blue" data-ng-class="{'filter-selected': game.filter === 'byRegion'}" id="showByRegion" data-ng-click="game.filterByRegion()" data-ng-class="{'active': game.filter == 'byRegion'}">
                                <strong>Color by region</strong>
                            </button>
                            <button type="button" class="button button-purple" data-ng-click="game.pause()" style="width: 46px; height: 34px;" data-ng-show="game.aiTurn">
                                <span class="glyphicon glyphicon-pause" aria-hidden="true" data-ng-show="game.gamePaused === game.pauseModes.NOT_PAUSED"></span>
                                <span data-ng-show="game.gamePaused === game.pauseModes.PAUSING">{{ game.pausingDots }}</span>
                                <span class="glyphicon glyphicon-play" aria-hidden="true" data-ng-show="game.gamePaused === game.pauseModes.PAUSED"></span>
                            </button>
                            <button type="button" class="button button-green" data-ng-click="game.openMenu()" style="height: 34px;">
                                MENU
                            </button>
                        </div>
                        <h4>Turn number <strong data-ng-bind="game.turn.turnNumber"></strong></h4>
                    </div>
                    <div class="col-xs-3 paddingTop--double " id="turnInfo">
                        <div class="row">
                            <div class="col-xs-9" style="line-height: 40px;" id="currentPhaseIndicator">
                                <div>
                                    <div data-ng-show="game.turn.turnPhase == 0" class="troop_{{ game.turn.player.color.name }}">
                                        <div>Deployment phase</div>
                                        <div data-ng-if="game.troopsToDeploy <= 9">
                                            <div id="mainTroopIndicator" class="floatLeft" data-ng-repeat="i in game.toArray(game.troopsToDeploy) track by $index">@@troopSvg</div>
                                        </div>
                                        <div data-ng-if="game.troopsToDeploy > 9">
                                            <div class="floatLeft">@@troopSvg</div>
                                            <span class="floatLeft paddingLeft">x{{ game.troopsToDeploy }}</span>
                                        </div>
                                        <div data-ng-if="game.troopsToDeploy === 0">
                                            <strong>No more reinforcements!</strong>
                                        </div>
                                    </div>
                                    <span data-ng-show="game.turn.turnPhase == 1">
                                        Attack phase
                                    </span>
                                    <span data-ng-show="game.turn.turnPhase == 2">
                                        Movement phase
                                    </span>
                                </div>
                            </div>
                            <div class="col-xs-3" style="line-height: 30px;">
                                <span id="nextButton"
                                      data-ng-click="game.nextTurn()"
                                      data-ng-show="!game.aiTurn"
                                      data-ng-class="{'nextButton--disabled': game.checkIfNextIsDisabled()}">
                                          <span>
                                              Next
                                          </span>
                                      </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                   <div id="map" data-ng-class="{'endScreen': main.currentGamePhase === main.gamePhases.END_SCREEN}"
                     style="background: #5397d1;
                            border-radius: 30px;
                            margin-top: 20px;
                            box-shadow: 3px 3px 8px #202020;">
                       @@mapSvg
                   </div>
                </div>
                <div class="row">
                    <div id="currentTerritoryInfo">
                    </div>
                </div>
            </div>
            <div data-ng-show="main.currentGamePhase == main.gamePhases.END_SCREEN" id="victoryScreen" ng-cloak>
                <div class="textCenter">
                    <h1>VICTORY</h1>
                    <h3 class="text-shadow" style="color: {{ game.playerWhoWon.color.mainColor }}">
                        {{ game.playerWhoWon.name }}
                    </h3>
                    <img id="victoryPortrait" class="marginTop--double" src="" alt="" data-ng-if="game.playerWhoWon">
                    <div id="victoryFlag" class='flag'></div>
                    <div style="margin-top: 90px;" data-ng-controller="endScreenTableController as endScreenTable">
                        <table id="endScreenTable">
                            <thead>
                                <tr>
                                    <th>Place</th>
                                    <th>Name</th>
                                    <th></th>
                                    <th class="textRight">Battles Won</th>
                                    <th class="textRight">Battles Lost</th>
                                    <th class="textRight">Retreats</th>
                                    <th class="textRight">Card combos used</th>
                                    <th class="textRight">Total reinforcements</th>
                                    <th class="textRight">Troops killed</th>
                                    <th class="textRight">Troops lost</th>
                                    <th class="textRight">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr data-ng-repeat="player in endScreenTable.players">
                                    <td data-ng-bind="player.rank" class="textCenter"></td>
                                    <td data-ng-bind="player.name"></td>
                                    <td>
                                        <waving-flag flag-width="60" flag-height="35" flag-url="player.avatar.flag"></waving-flag>
                                    </td>
                                    <td data-ng-bind="player.statistics.battlesWon" class="textRight"></td>
                                    <td data-ng-bind="player.statistics.battlesLost" class="textRight"></td>
                                    <td data-ng-bind="player.statistics.retreats" class="textRight"></td>
                                    <td data-ng-bind="player.statistics.cardCombinationsUsed" class="textRight"></td>
                                    <td data-ng-bind="player.statistics.totalReinforcements" class="textRight"></td>
                                    <td data-ng-bind="player.statistics.troopsKilled" class="textRight"></td>
                                    <td data-ng-bind="player.statistics.troopsLost" class="textRight"></td>
                                    <td>
                                        <span data-ng-show="player.dead">
                                            Dead (Turn {{ player.deadTurn }})
                                        </span>
                                        <span data-ng-show="!player.dead">
                                            Alive
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <button type="button" class="button button-purple" data-ng-click="main.goBackToMenu()" style="margin-top: 100px;">
                        <strong>Back to Menu</strong>
                    </button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>